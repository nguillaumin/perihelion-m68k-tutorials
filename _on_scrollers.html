<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="perihelion of poSTmortem">
<title>The Atari ST MC68000 Assembly Language Tutorials</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<a href="https://github.com/nguillaumin/perihelion-m68k-tutorials"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="_on_scrollers" class="book toc2 toc-left">
<div id="header">
<h1>The Atari ST MC68000 Assembly Language Tutorials</h1>
<div class="details">
<span id="author" class="author">perihelion of poSTmortem</span><br>
<span id="revnumber">version 1st edition (v0.84),</span>
<span id="revdate">August 28th 2004 | edited by bp</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">The Atari ST MC68000 Assembly Language Tutorials</a></span></p><ul class="sectlevel1">
<li><a href="_foreword.html">Foreword</a>
</li>
<li><a href="_on_the_theory_behind_programming.html">On The Theory Behind Programming</a>
</li>
<li><a href="_of_the_workings_of_devpac_3_and_the_realisation_of_some_code.html">Of The Workings Of Devpac 3 And The Realisation Of Some Code</a>
</li>
<li><a href="_of_various_things_mystic_and_important_mainly_concerning_the_art_of_understanding_digits_and_performing_traps.html">Of Various Things Mystic And Important, Mainly Concerning The Art Of Understanding Digits And Performing Traps</a>
</li>
<li><a href="_of_the_ways_of_addressing_memory.html">Of The Ways Of Addressing Memory</a>
</li>
<li><a href="_of_the_workings_of_the_graphics_memory_and_minor_skills_in_branching.html">Of The Workings Of The Graphics Memory And Minor Skills In Branching</a>
</li>
<li><a href="_of_seeing_behind_the_curtain_of_an_execution_and_getting_intimate_with_files.html">Of Seeing Behind The Curtain Of An Execution And Getting Intimate With Files</a>
</li>
<li><a href="_on_scrollers.html"><span class="toc-current">On Scrollers</span></a>
</li>
<li><a href="_of_scrolling_8_pixels_per_vbl_using_double_buffer.html">Of Scrolling 8 Pixels Per VBL Using Double Buffer</a>
</li>
<li><a href="_of_revealing_the_unseen_and_expanding_our_consciousness_without_the_use_of_illegal_drugs.html">Of Revealing The Unseen And Expanding Our Consciousness Without The Use Of Illegal Drugs</a>
</li>
<li><a href="_of_lighting_a_candle_and_casting_a_shadow.html">Of Lighting A Candle (And Casting A Shadow)</a>
</li>
<li><a href="_of_making_the_mountain_move_to_mohammed.html">Of Making The Mountain Move To Mohammed</a>
</li>
<li><a href="_of_controlling_the_puppets.html">Of Controlling The Puppets</a>
</li>
<li><a href="_of_hearing_that_which_is_spoken.html">Of Hearing That Which Is Spoken</a>
</li>
<li><a href="_of_using_the_gramophone.html">Of Using The Gramophone</a>
</li>
<li><a href="_on_fading_to_black.html">On Fading To Black</a>
</li>
<li><a href="_appendixes.html">Appendixes</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_on_scrollers">On Scrollers</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>2002-06-14 (last edition of the initial revision)</em></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>My grandfather taught me the energy of life goes in a circle, in a
perfect flow; balanced. He said, until I find my centre, my circle
will never be whole</p>
</div>
</blockquote>
<div class="attribution">
&#8212; The One
</div>
</div>
<div class="paragraph">
<p>Huh, so finally, as promised; the tutorial on scrollers. BTW, all my "huh" sounds aren&#8217;t like
American huh, as in a question or as in a "oh yeah?", but rather phew, like a sigh. Have you
been waiting for this one? I hope you have, because it was a damn pain in the ass to write
the scroller program, even though it&#8217;s simple. It began with me reaching too high, also,
forgetting about the bitplane layout of the graphics memory. When I put a little lower
ambition level, for the sake of keeping it simple, things went smoother. Now, Luca Turilli
playing in Winamp, the mood is set, time to write. The people who already know how to do
scrollers will probably laugh their ass off at this clumsy scroller, which really is bad in every
way except learning the basic stuff, I&#8217;ll probably do a more advanced one later on; I&#8217;ve heard
that building on knowledge is good.</p>
</div>
<div class="paragraph">
<p>A few happy news first. I&#8217;ve gotten mail from three different people, excluding Maarten
Martens. Thanks guys, you know who you are! One mail from FrEd highlighted a few misses I
made, concerning the compatibility with Devpac 2. My initlib had a little bug. It works fine in
Devpac 3, but not in 2. Two lines had <code>d0-7</code> in them, it really should read <code>d0-d7</code>, but it&#8217;s fixed
now. I know some other things may also be difficult with other assemblers than Devpac 3, so
if the code doesn&#8217;t work for you, just use Devpac 3. I have tested every piece of code with
that on an original Atari ST(e), so there should be no problem. Thanks go out to FrEd for
pointing this out, and also to mOdmate of Checkpoint for telling me a little about the
workings of <code>$fffc02</code>.</p>
</div>
<div class="paragraph">
<p>Yep, a scroller. I&#8217;m a bit unsure of where to start, but I guess I&#8217;ll just work from the top
down. What does a scroller do? Letters go from the right of the screen, to the left of the
screen (usually). New letters are brought in from the right, "outside" of the screen. How can
this be achieved? The screen memory needs to be moved "to the left", and then we need
information to bring in the new characters from the right. OK, this seems to build on an idea
to have letters stored as graphics. Hum, yes, we have a font collection in a degas file. In that
way, we&#8217;ll have letters in graphics format, we can take the information from the font file and
put it on the screen. Then, we move the screen memory to the left. Easy? No, damn hard for
a first timer at least.</p>
</div>
<div class="paragraph">
<p>Included in this tutorial should be a file called <code>font.pi1</code>, this is the font file, I stole it from
James Ingram&#8217;s demo tutorials, so I wouldn&#8217;t have to make my own. Immediately load this
up and look at it, either using Degas, the program from Chapter 6 or any other method.
Lucky lucky, lots of characters to choose from. Each character is 32 × 32 pixels big, resulting
in 10 characters per line. This is all well and fine, the next step is to actually know how to
point to the beginning of, for example, letter <code>C</code>. If we know where this letter begins, we can
put it on our screen simply by moving the data into the screen memory. Just as we did when
displaying a whole picture.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/tutorial-07-font.gif" alt="tutorial 07 font">
</div>
<div class="title">Figure 6. font.pi1</div>
</div>
<div class="paragraph">
<p>The font picture is aligned with the ASCII table, meaning that it looks like the ASCII table
does. In the <a href="appendixes/ascii-table.txt">ASCII Table</a>, by Stephen McNabb, you&#8217;ll find an ASCII
table, in which you can look up the number for each character. As you can see, space (the
first character in the font), begins at <code>$20</code>, then comes <code>!</code> at <code>$21</code> and so on. This means, that if
we take the ASCII value for a character, and subtract by <code>$20</code>, we&#8217;ll have the corresponding
number in the font. Hum, a test perhaps. <code>C</code> is at <code>$43</code> in ASCII, subtract <code>$20</code> makes <code>$23</code>,
which is 35 (decimal). There are 10 characters per line, so we skip to the fourth line, begin
counting; 0 (&gt;), 1(?), 2(@), 3(A), 4(B), 5&#169;, yay, right on! (remember to start counting from
0).</p>
</div>
<div class="paragraph">
<p>Now we need to know what address this is at. The way to do this is to put the beginning of
the font picture address in an address register, and increment by a number. Think of the font
as a coordinate system, then <code>C</code> would be at 3,5. We need to increment the pointer by a
certain value for each coordinate, this shouldn&#8217;t be to hard.</p>
</div>
<div class="paragraph">
<p>Each line is 160 bytes, and each character is 32 lines. This means that for every Y coordinate,
we need to increment the pointer by 32 × 160 bytes, right? Think about it, if we want <code>*</code>
which is on the second line (1,0), we need to point to the font address + 32 lines down. Each
character is 32 pixels wide, 16 pixels are 4 words, taking up 8 bytes, we need twice this. So
for each X coordinate, we need to increment the pointer by 16 bytes.</p>
</div>
<div class="paragraph">
<p>Does this seem right? Let&#8217;s try. We want letter <code>C</code>, at 3,5. Thus we should increment by
3×32×160 + 5×16 = 15440 bytes. <code>C</code> is about the middle of the screen and 15440 is about
half of 32000, so it seems safe to assume that the formula above is working. Question is,
how do we get the X and Y coordinates? We had a value for C, right, that was 35. The first
digit seems to be the Y coordinate, and the second the X coordinate. If we divide 35 by 10
we get 3.5. 3 is the quotient and 5 the remainder. The instruction <code>divu</code> (<strong>DIV</strong>ide <strong>U</strong>nsigned)
puts the quotient in the lower word of a data register, and the remainder in the higher word.
<code>swap</code> is an instruction that swaps the low and high word in a data register. Great! We now
have what we need. The code looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="nv">character</span><span class="p">,</span> <span class="nb">a0</span>           <span class="c1">; points to character</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="nv">font</span><span class="o">+</span><span class="mi">34</span><span class="p">,</span> <span class="nb">a1</span>             <span class="c1">; points to pixel start</span>

                <span class="k">move</span><span class="nd">.b </span> <span class="p">(</span><span class="nb">a0</span><span class="p">),</span> <span class="nb">d0</span>                 <span class="c1">; put letter ascii value in d0</span>

                <span class="k">add</span><span class="nd">.b </span>  <span class="nd">#</span><span class="o">-</span><span class="mh">$20</span><span class="p">,</span> <span class="nb">d0</span>                <span class="c1">; align asciin with font number</span>
                <span class="k">divu</span>    <span class="nd">#</span><span class="mi">10</span><span class="p">,</span> <span class="nb">d0</span>                  <span class="c1">; 10 letters per row</span>

                <span class="k">move</span><span class="nd">.w </span> <span class="nb">d0</span><span class="p">,</span> <span class="nb">d1</span>                   <span class="c1">; d1 contains y value</span>
                <span class="k">swap</span>    <span class="nb">d0</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nb">d0</span><span class="p">,</span> <span class="nb">d2</span>                   <span class="c1">; d2 contains x value</span>

                <span class="k">mulu</span>    <span class="nd">#</span><span class="mi">16</span><span class="p">,</span> <span class="nb">d2</span>                  <span class="c1">; 16 bytes for each letter</span>
                <span class="k">mulu</span>    <span class="nd">#</span><span class="mi">32</span><span class="p">,</span> <span class="nb">d1</span>                  <span class="c1">; 32 lines per row</span>
                <span class="k">mulu</span>    <span class="nd">#</span><span class="mi">160</span><span class="p">,</span> <span class="nb">d1</span>                 <span class="c1">; 160 bytes per row</span>

                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="nv">font</span><span class="o">+</span><span class="mi">34</span><span class="p">,</span> <span class="nb">a0</span>             <span class="c1">; put font screen start in a0</span>

                <span class="k">add</span><span class="nd">.l </span>  <span class="nb">d2</span><span class="p">,</span> <span class="nb">d1</span>                   <span class="c1">; add x and y value together</span>
                <span class="k">add</span><span class="nd">.l </span>  <span class="nb">d1</span><span class="p">,</span> <span class="nb">a0</span>                   <span class="c1">; a0 points to correct letter</span>

                <span class="kr">section</span> <span class="nv">data</span>
<span class="nl">font</span>            <span class="kr">incbin</span>  <span class="nv">font</span><span class="p">.</span><span class="nv">pi1</span>
<span class="nl">character</span>       <span class="kt">dc</span><span class="nd">.b </span>   <span class="s">"C"</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since each character is an ASCII value, we only use a byte to represent it. If we put things
inside "", that means we want the ASCII value. So the message <code>dc.b "C"</code>, means that
message is a byte containing the ASCII value for C. We could just as well have written
message <code>dc.b $43</code>, but this is more difficult to understand. Hopefully, the code will speak for
itself with the comments and the theory given above. This is not a complete program, but
just a code snippet to show the font part. More will follow.</p>
</div>
<div class="paragraph">
<p>We know how to point to the font, now we need to know how to shift the screen memory, in
order to achieve the scrolling effect. One would think that all it took was a big loop moving
bytes. Like so (<code>a0</code> and <code>a1</code> contain the address of the screen memory)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">add</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">1</span><span class="p">,</span> <span class="nb">a1</span>                   <span class="c1">; put a1 8 pixels ahead of a0</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">159</span><span class="p">,</span> <span class="nb">d0</span>                 <span class="c1">; scroll a line</span>
<span class="nl">loop</span>
                <span class="k">move</span><span class="nd">.b </span> <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For each loop we take the byte one byte ahead, and move it one byte to the left. This should
move 8 pixels each loop, right? Wrong! Totally wrong! The screen is made of 16 pixel
clusters, each cluster being 8 bytes long. So when you just barge in and move single bytes
like that, you&#8217;ll misalign the whole shit. Not only will the colours be misaligned, the pixels will
be as well. Consider this memory configuration.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">First byte</th>
<th class="tableblock halign-center valign-top">Second byte</th>
<th class="tableblock halign-center valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%11000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">first word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%11000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000101</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">second word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%01000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000110</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">third word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%01100000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">fourth word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">&#8230;&#8203;</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">fifth word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"></td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$3F800000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$00000642</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">pixels</p></td>
</tr>
</tfoot>
</table>
<div class="paragraph">
<p>If we use the move loop from above, the first byte will drop out, the second byte will be
moved into the first byte, the first byte of the second word will go into the second byte of the
first word and so on, in the end, we get this.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">First byte</th>
<th class="tableblock halign-center valign-top">Second byte</th>
<th class="tableblock halign-center valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%11000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">first word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000101</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%01000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">second word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000110</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%01100000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">third word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">%00000000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">fourth word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="3"></td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$00000542</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">$17400000</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">pixels</p></td>
</tr>
</tfoot>
</table>
<div class="paragraph">
<p>Not really, the pixels we had before. So, in order to overcome this in an easy way we move
16 pixels each time. This will produce a very fast scroller, but an easy one to code for. If we
move 16 pixels, we won&#8217;t have to worry about getting misaligned bitplanes, since the 16 pixel
clusters will never be broken up, like they were above. <code>a0</code> and <code>a1</code> contains the screen
address, while <code>a2</code> points to the character in the font.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">add</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">8</span><span class="p">,</span> <span class="nb">a1</span>                   <span class="c1">; put a1 16 pixels ahead of a0</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">31</span><span class="p">,</span> <span class="nb">d1</span>                  <span class="c1">; 32 lines to scroll</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">18</span><span class="p">,</span> <span class="nb">d0</span>                  <span class="c1">; 19 16 pixel clusters + font part</span>
<span class="nl">scroll</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>             <span class="c1">; 16 pixels moved</span>
                <span class="k">dbf</span>     <span class="nb">d0</span><span class="p">,</span> <span class="nv">scroll</span>               <span class="c1">; keep moving 16 pixel clusters</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">18</span><span class="p">,</span> <span class="nb">d0</span>                  <span class="c1">; reset loop counter</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="mi">2</span><span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="mi">4</span><span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>             <span class="c1">; 16 pixels of the font</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="mi">6</span><span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>             <span class="c1">; character moved in</span>
                <span class="k">add</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">8</span><span class="p">,</span> <span class="nb">a1</span>                   <span class="c1">; increment screen pointer, align with</span>
                                                 <span class="c1">; a0</span>
                <span class="k">add</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">160</span><span class="p">,</span> <span class="nb">a2</span>                 <span class="c1">; next line of font</span>
                <span class="k">dbf</span>     <span class="nb">d1</span><span class="p">,</span> <span class="nv">scroll</span>               <span class="c1">; do another line</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is all just a bunch of move words, and some adds to keep everything aligned. The first
move section will move 4 words from <code>a1</code>, which points one 16 bit cluster ahead of <code>a0</code>, to <code>a0</code>.
This is repeated 19 times. After this loop, <code>a0</code> points to the beginning of the last 16 pixel
cluster, and <code>a0</code> points to the beginning of the second line. For the last 16 pixel cluster, we
want information from the font, not from the screen. So here we move information from <code>a2</code>
into <code>a0</code>. Instead of post incrementing <code>a2</code>, I use indexes. After the font data is moved onto the
screen, I add 8 to <code>a1</code>, so that it will again be 16 pixels ahead of <code>a0</code>. Since <code>a0</code> was incremented
during the font move part, and <code>a1</code> was not. 160 is added to <code>a2</code>, so that the font pointer will
now point to the next line in the font. Repeat for 32 lines.</p>
</div>
<div class="paragraph">
<p>Now the two most important techniques have been covered, how to know where the
character is in the font, and how to scroll. Now we mix and match. In order to synchronize
the entire scroller to the VBL, I put a wait VBL trap in the beginning of the main loop. Then I
do my stuff, and in the end of the main loop, I check if the space bar is pressed, if it is, just
drop out of the loop. If space bar is not pressed, then the main loop will begin again, with a
VBL wait, making sure that the main loop is looped through at 50 times a second. You&#8217;ll
probably be wondering exactly how I determine whether the space bar is pressed.</p>
</div>
<div class="paragraph">
<p>This little piece will do the trick: <code>cmp.b #$39, $fffc02</code>. Uh, says you, looking at the ASCII table
(hopefully) and wondering how <code>$39</code> can be space, when it should be <code>$20</code>. The <code>$fffc02</code> part
can be easily guessed, this is probably where the last key press end up, but why <code>$39</code>? ASCII
deals with characters, and special characters like line feed and so. There&#8217;s also something
called scan codes. Every key on the keyboard has its value, its scan code, so you&#8217;ll be able to
determine what key was pressed. Look at the picture below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="img/scancode.gif" alt="scancode">
</div>
<div class="title">Figure 7. Keyboard Scan Codes</div>
</div>
<div class="paragraph">
<p>While we&#8217;re still on the topic, I might as well give you the full detail. You can also check when
a key is released, not just pressed. When the key is released, the high bit of <code>$fffc02</code> is set,
meaning you get a whole different value. Consider this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k"><span class="mb">%00111001</span> <span class="mh">$39</span> <span class="nv">space</span> <span class="nv">pressed</span>
<span class="mb">%10111001</span> <span class="mh">$b9</span> <span class="nv">space</span> <span class="nv">released</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>So, if you <code>cmp.b #$b9</code>, then you check if space is released. This can be used in many fun
ways, like changing the background to red when space is pressed, then checking to see when
space is released and then restore background. Or accelerate a car in a car game until the
button is released, at which time you begin deceleration. I don&#8217;t know how often this is
updated or how fast you can really press keys. Say for example that you check <code>$fffc02</code> every
VBL to see what key is pressed and released, suppose this dude is like Flash, and manage to
press a button, then release it and press another within 1/50 of a second, then you&#8217;d loose
the check for the release of the key, but I doubt you&#8217;ll have to worry about this. Back to
reality, here&#8217;s the scroller.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">jsr</span>     <span class="nv">initialise</span>
               
                <span class="k">movem</span><span class="nd">.l </span><span class="nv">font</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="nb">d0</span><span class="o">-</span><span class="nb">d7</span>
                <span class="k">movem</span><span class="nd">.l </span><span class="nb">d0</span><span class="o">-</span><span class="nb">d7</span><span class="p">,</span> <span class="mh">$ff8240</span>
                
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; get physbase</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nb">a7</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="nv">screen</span>               <span class="c1">; store screen memory</span>
 
<span class="nl">main</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nv">sp</span><span class="p">)</span>               <span class="c1">; wait vbl</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nv">sp</span>
               
                <span class="k">cmp</span>     <span class="nd">#</span><span class="mi">0</span><span class="p">,</span> <span class="nv">font_counter</span>         <span class="c1">; check if new character in message</span>
                <span class="k">bne</span>     <span class="nv">has_character</span>            <span class="c1">; if not, skip get new character</span>
                
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nv">font_counter</span>         <span class="c1">; reset font_counter</span>
<span class="c1">; we need to point to a new characetr in the font</span>

                <span class="k">move</span><span class="nd">.l </span> <span class="nv">message_pointer</span><span class="p">,</span> <span class="nb">a0</span>      <span class="c1">; pointer into the message</span>
                <span class="k">clr</span><span class="nd">.l </span>  <span class="nb">d0</span>                       <span class="c1">; clear, just to be sure</span>
                <span class="k">move</span><span class="nd">.b </span> <span class="p">(</span><span class="nb">a0</span><span class="p">),</span> <span class="nb">d0</span>                 <span class="c1">; put letter ascii value in d0</span>

                <span class="k">cmp</span>     <span class="nd">#</span><span class="mi">0</span><span class="p">,</span> <span class="nb">d0</span>                   <span class="c1">; end of message?</span>
                <span class="k">bne</span>     <span class="nv">not_end</span>                  <span class="c1">; if not, branch</span>
                
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="nv">message</span><span class="p">,</span> <span class="nv">message_pointer</span><span class="c1">; reset message_pointer</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nv">message_pointer</span><span class="p">,</span> <span class="nb">a0</span>
                <span class="k">clr</span><span class="nd">.l </span>  <span class="nb">d0</span>                       <span class="c1">; clear, just to be sure</span>
                <span class="k">move</span><span class="nd">.b </span> <span class="p">(</span><span class="nb">a0</span><span class="p">),</span> <span class="nb">d0</span>                 <span class="c1">; put letter ascii value in d0</span>
 
<span class="nl">not_end</span>
<span class="c1">; now we have a character in d0 for sure</span>
               <span class="k">add</span><span class="nd">.l </span>   <span class="nd">#</span><span class="mi">1</span><span class="p">,</span> <span class="nv">message_pointer</span>      <span class="c1">; point to next character</span>
              
               <span class="k">add</span><span class="nd">.b </span>   <span class="nd">#</span><span class="o">-</span><span class="mh">$20</span><span class="p">,</span> <span class="nb">d0</span>                <span class="c1">; align ascii with font number</span>
               <span class="k">divu</span>     <span class="nd">#</span><span class="mi">10</span><span class="p">,</span> <span class="nb">d0</span>                  <span class="c1">; 10 letters per row</span>
               
               <span class="k">move</span><span class="nd">.w </span>  <span class="nb">d0</span><span class="p">,</span> <span class="nb">d1</span>                   <span class="c1">; d1 contains y value</span>
               <span class="k">swap</span>     <span class="nb">d0</span>
               <span class="k">move</span><span class="nd">.w </span>  <span class="nb">d0</span><span class="p">,</span> <span class="nb">d2</span>                   <span class="c1">; d2 contains x value</span>
              
               <span class="k">mulu</span>     <span class="nd">#</span><span class="mi">16</span><span class="p">,</span> <span class="nb">d2</span>                  <span class="c1">; 16 bytes for each letter</span>
               <span class="k">mulu</span>     <span class="nd">#</span><span class="mi">32</span><span class="p">,</span> <span class="nb">d1</span>                  <span class="c1">; 32 lines per row</span>
               <span class="k">mulu</span>     <span class="nd">#</span><span class="mi">160</span><span class="p">,</span> <span class="nb">d1</span>                 <span class="c1">; 160 bytes per row</span>
              
               <span class="k">move</span><span class="nd">.l </span>  <span class="nd">#</span><span class="nv">font</span><span class="o">+</span><span class="mi">34</span><span class="p">,</span> <span class="nb">a0</span>             <span class="c1">; put font screen start in a0</span>
              
               <span class="k">add</span><span class="nd">.l </span>   <span class="nb">d2</span><span class="p">,</span> <span class="nb">d1</span>                   <span class="c1">; add x and y value together</span>
               <span class="k">add</span><span class="nd">.l </span>   <span class="nb">d1</span><span class="p">,</span> <span class="nb">a0</span>                   <span class="c1">; a0 points to correct letter</span>
              
               <span class="k">move</span><span class="nd">.l </span>  <span class="nb">a0</span><span class="p">,</span> <span class="nv">font_address</span>         <span class="c1">; store calculated pointer</span>
  
<span class="nl">has_character</span>
               <span class="k">add</span><span class="nd">.w </span>   <span class="nd">#</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nv">font_counter</span> 
              
               <span class="k">move</span><span class="nd">.l </span>  <span class="nv">screen</span><span class="p">,</span> <span class="nb">a0</span>
               <span class="k">move</span><span class="nd">.l </span>  <span class="nv">screen</span><span class="p">,</span> <span class="nb">a1</span>
               <span class="k">move</span><span class="nd">.l </span>  <span class="nv">font_address</span><span class="p">,</span> <span class="nb">a2</span>
               <span class="k">add</span><span class="nd">.l </span>   <span class="nd">#</span><span class="mi">8</span><span class="p">,</span> <span class="nb">a1</span>                   <span class="c1">; put a1 16 pixels ahead of a0</span>
              
               <span class="k">move</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">31</span><span class="p">,</span> <span class="nb">d1</span>                  <span class="c1">; 32 lines to scroll</span>
               <span class="k">move</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">18</span><span class="p">,</span> <span class="nb">d0</span>                  <span class="c1">; 19 16 pixel clusters + font part</span>
<span class="nl">scroll</span>
               <span class="k">move</span><span class="nd">.w </span>  <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span> 
               <span class="k">move</span><span class="nd">.w </span>  <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span> 
               <span class="k">move</span><span class="nd">.w </span>  <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
               <span class="k">move</span><span class="nd">.w </span>  <span class="p">(</span><span class="nb">a1</span><span class="p">)</span><span class="o">+</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>             <span class="c1">; 16 pixels moved</span>
               <span class="k">dbf</span>      <span class="nb">d0</span><span class="p">,</span> <span class="nv">scroll</span>               <span class="c1">; keep moving 16 pixel clusters</span>
               
               <span class="k">move</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">18</span><span class="p">,</span> <span class="nb">d0</span>                  <span class="c1">; reset loop counter</span>
               
               <span class="k">move</span><span class="nd">.w </span>  <span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
               <span class="k">move</span><span class="nd">.w </span>  <span class="mi">2</span><span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
               <span class="k">move</span><span class="nd">.w </span>  <span class="mi">4</span><span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>             <span class="c1">; 16 pixels of the font </span>
               <span class="k">move</span><span class="nd">.w </span>  <span class="mi">6</span><span class="p">(</span><span class="nb">a2</span><span class="p">),</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>             <span class="c1">; character moved in </span>
               <span class="k">add</span><span class="nd">.l </span>   <span class="nd">#</span><span class="mi">8</span><span class="p">,</span> <span class="nb">a1</span>                   <span class="c1">; increment screen pointer, align with a0</span>
               <span class="k">add</span><span class="nd">.l </span>   <span class="nd">#</span><span class="mi">160</span><span class="p">,</span> <span class="nb">a2</span>                 <span class="c1">; next line of font</span>
               
               <span class="k">dbf</span>      <span class="nb">d1</span><span class="p">,</span> <span class="nv">scroll</span>               <span class="c1">; do another line</span>
               
               <span class="k">add</span><span class="nd">.l </span>   <span class="nd">#</span><span class="mi">8</span><span class="p">,</span> <span class="nv">font_address</span>         <span class="c1">; move 16 pixels forward in font</span>
               
               <span class="k">cmp</span><span class="nd">.b </span>   <span class="nd">#</span><span class="mh">$39</span><span class="p">,</span> <span class="mh">$fffc02</span>            <span class="c1">; space pressed?</span>
               <span class="k">bne</span>      <span class="kr">main</span>                     <span class="c1">; if not, repeat main</span>
               
               <span class="k">jsr</span>      <span class="nv">restore</span>
 
               <span class="k">clr</span><span class="nd">.l </span>   <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>
               <span class="k">trap</span>     <span class="nd">#</span><span class="mi">1</span>

               <span class="kr">include</span> <span class="nv">initlib</span><span class="nd">.s
</span>
               <span class="kr">section</span> <span class="nv">data</span>

<span class="nl">font</span>           <span class="kr">incbin</span>  <span class="nv">font</span><span class="p">.</span><span class="nv">pi1</span>
<span class="nl">screen</span>         <span class="kt">dc</span><span class="nd">.l </span>   <span class="mi">0</span>
<span class="nl">font_address</span>   <span class="kt">dc</span><span class="nd">.l </span>   <span class="mi">0</span>
<span class="nl">font_counter</span>   <span class="kt">dc</span><span class="nd">.w </span>   <span class="mi">0</span>

<span class="nl">message</span>        <span class="kt">dc</span><span class="nd">.b </span>   <span class="s">"A  COOL  SCROLLER!    BUT  A  BIT  FAST, "</span>
               <span class="kt">dc</span><span class="nd">.b </span>   <span class="s">"  SCROLLING  16  PIXELS  EACH  VBL."</span>
               <span class="kt">dc</span><span class="nd">.b </span>   <span class="s">"    THAT'S 2.5 SCREENS EACH SECOND!"</span>
               <span class="kt">dc</span><span class="nd">.b </span>   <span class="s">"             "</span><span class="p">,</span> <span class="mi">0</span>

<span class="nl">message_pointer</span> <span class="kt">dc</span><span class="nd">.l </span>  <span class="nv">message</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/tutorial-07-screenshot.png" alt="tutorial 07 screenshot">
</div>
<div class="title">Figure 8. A scroller</div>
</div>
<div class="paragraph">
<p>There are really only two more small things that are new; the font counter and the message
pointer. Also take note how I put in the scrolling message, by just using lots of <code>dc.b</code>, and a <code>0</code>
as an end control character. By changing the text here, you can obviously change the scroller
message. Perhaps to the well known "Hello World!", which I most deliberately avoided.</p>
</div>
<div class="paragraph">
<p>So what&#8217;s the font counter and message address? Well, the font counter keeps track of when
it&#8217;s time to calculate a new address for a new character. This is set to 2, because every
second loop, a whole character has been moved to the screen and the address for the next
character in the message will have to be calculated. Had we scrolled 8 pixels each VBL, the
font counter would have been set to 4 instead.</p>
</div>
<div class="paragraph">
<p>The message pointer is an index into the message. In order to know which character to get
next time, we must have some pointer into the message. The message pointer begins by
pointing to the message, which is good, since that&#8217;s where the first character is. The first
time through the main loop, the font counter will announce that an address for a new
character will have to be calculated. That address is calculated and stored. The message
pointer will then point to the next character in the scroller message, which is space, and so
on. When the whole message has been scrolled through, the value 0 (not character <code>0</code>) will
be moved from the message. This is a signal that the message is at an end, and the message
pointer will be reset, once again pointing to the start of the message. I hope it&#8217;s
understandable, the one tricky part is all the tests and branches, just walk through them a
couple of times, slowly. You can use pen and paper for this, or the MonST.</p>
</div>
<div class="paragraph">
<p>We&#8217;ve begun to get somewhere. If you&#8217;ve paid attention so far, you&#8217;ll have acquired quite
some programming skills. There are still some basic things to cover, in order to be really self
sufficient (mainly timers, double buffering, sprites and bit manipulation) but you&#8217;re on a good
way. Now might be the time to look at alternative sources and learn something from there.
For example, you could begin to look at James Ingram&#8217;s demo coding tutorials. That was
where I began, I found them quite hard but now we&#8217;ve gotten more or less to the level
where he begins his stuff. That is that from me right now. Upon request from mOdmate of
Checkpoint, the next tutorial will probably be on timers, I think. This means we&#8217;ll be able to
remove the bottom and top borders, cool stuff!</p>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>← Previous: <a href="_of_seeing_behind_the_curtain_of_an_execution_and_getting_intimate_with_files.html">Of Seeing Behind The Curtain Of An Execution And Getting Intimate With Files</a> | ↑ Up: <a href="index.html">The Atari ST MC68000 Assembly Language Tutorials</a> | Next: <a href="_of_scrolling_8_pixels_per_vbl_using_double_buffer.html">Of Scrolling 8 Pixels Per VBL Using Double Buffer</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1st edition (v0.84)<br>
Last updated 2022-04-18 16:48:36 UTC
</div>
</div>
</body>
</html>