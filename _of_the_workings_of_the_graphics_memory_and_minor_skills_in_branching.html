<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="perihelion of poSTmortem">
<title>The Atari ST MC68000 Assembly Language Tutorials</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sa {
  color: #000000;
  font-weight: bold;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
<a href="https://github.com/nguillaumin/perihelion-m68k-tutorials"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>
<style>.toc-current{font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="_of_the_workings_of_the_graphics_memory_and_minor_skills_in_branching" class="book toc2 toc-left">
<div id="header">
<h1>The Atari ST MC68000 Assembly Language Tutorials</h1>
<div class="details">
<span id="author" class="author">perihelion of poSTmortem</span><br>
<span id="revnumber">version 1st edition (v0.84),</span>
<span id="revdate">August 28th 2004 | edited by bp</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">The Atari ST MC68000 Assembly Language Tutorials</a></span></p><ul class="sectlevel1">
<li><a href="_foreword.html">Foreword</a>
</li>
<li><a href="_on_the_theory_behind_programming.html">On The Theory Behind Programming</a>
</li>
<li><a href="_of_the_workings_of_devpac_3_and_the_realisation_of_some_code.html">Of The Workings Of Devpac 3 And The Realisation Of Some Code</a>
</li>
<li><a href="_of_various_things_mystic_and_important_mainly_concerning_the_art_of_understanding_digits_and_performing_traps.html">Of Various Things Mystic And Important, Mainly Concerning The Art Of Understanding Digits And Performing Traps</a>
</li>
<li><a href="_of_the_ways_of_addressing_memory.html">Of The Ways Of Addressing Memory</a>
</li>
<li><a href="_of_the_workings_of_the_graphics_memory_and_minor_skills_in_branching.html"><span class="toc-current">Of The Workings Of The Graphics Memory And Minor Skills In Branching</span></a>
</li>
<li><a href="_of_seeing_behind_the_curtain_of_an_execution_and_getting_intimate_with_files.html">Of Seeing Behind The Curtain Of An Execution And Getting Intimate With Files</a>
</li>
<li><a href="_on_scrollers.html">On Scrollers</a>
</li>
<li><a href="_of_scrolling_8_pixels_per_vbl_using_double_buffer.html">Of Scrolling 8 Pixels Per VBL Using Double Buffer</a>
</li>
<li><a href="_of_revealing_the_unseen_and_expanding_our_consciousness_without_the_use_of_illegal_drugs.html">Of Revealing The Unseen And Expanding Our Consciousness Without The Use Of Illegal Drugs</a>
</li>
<li><a href="_of_lighting_a_candle_and_casting_a_shadow.html">Of Lighting A Candle (And Casting A Shadow)</a>
</li>
<li><a href="_of_making_the_mountain_move_to_mohammed.html">Of Making The Mountain Move To Mohammed</a>
</li>
<li><a href="_of_controlling_the_puppets.html">Of Controlling The Puppets</a>
</li>
<li><a href="_of_hearing_that_which_is_spoken.html">Of Hearing That Which Is Spoken</a>
</li>
<li><a href="_of_using_the_gramophone.html">Of Using The Gramophone</a>
</li>
<li><a href="_on_fading_to_black.html">On Fading To Black</a>
</li>
<li><a href="_appendixes.html">Appendixes</a>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_of_the_workings_of_the_graphics_memory_and_minor_skills_in_branching">Of The Workings Of The Graphics Memory And Minor Skills In Branching</h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>2002-07-01 (last edition of the initial revision)</em></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>She doth teach the torches to burn bright</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Romeo and Juliet
</div>
</div>
<div class="paragraph">
<p>It&#8217;s 10:13 in the morning, school will start at 1 o&#8217;clock so I have some spare time before I&#8217;m
at it. I&#8217;ve hooked Direct Connect up on some downloads; one Bruce Lee movie and one Yun
Fat Chow movie, I&#8217;ve loaded over 70 minutes worth of Atari chip music in Winamp, time to do
some serious writing.</p>
</div>
<div class="paragraph">
<p>As promised in the title, this tutorial will be all about the graphics memory, which really is all
you need to manipulate graphics on the Atari. So, if you really try hard, you should be able to
do scrollers after reading this tutorial, but don&#8217;t overextend; I plan to cover scrollers in the
next tutorial anyways, because they are so good to practice your skills. First though, I
thought I&#8217;d take a quick repetition and just go over a few basic things.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Symbol</th>
<th class="tableblock halign-center valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>#</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">decimal value</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>#%</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">binary value</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>#$</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">hexadecimal value</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>$</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">memory address, expressed in hexadecimal</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>.b</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Byte</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>.w</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>.l</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">Longword</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>One bit is either a 1 or a 0. There are 8 bits to a byte, two bytes to a word and 2 words to a
longword, meaning there are four bytes to a longword. BTW, four bits are called a nibble,
which is half a byte. The smallest addressable memory block is a byte, meaning that every
count of an address is a byte. This means that if <code>a0</code> points to <code>$100</code>, and you do a <code>move.w
#10, -(a0)</code>, a0 will point to $98. <code>A0</code> will decrement by two, because a word is two bytes. If <code>a0</code>
points at <code>$100</code>, and you do a <code>move.l #10, (a0)+</code>, the value in a0 will be <code>$104</code>, since a
longword is four bytes. The value at memory address <code>$100</code> will be 10, also, in the previous
example with post decrementation, the value at <code>$98</code> will be 10, we don&#8217;t know the value of
<code>$100</code>.</p>
</div>
<div class="paragraph">
<p>I find it easiest to organize my files on the PC, and then transfer what I need to the Atari.
You can booo all you want, I don&#8217;t care! It&#8217;s really easy to transfer stuff to the Atari, all you
need is a diskette formatted in the correct way, you can even use a PC diskette. If you look
at an old Atari disk, and a new PC disk, you will see one big difference; there is a hole on the
left side of the PC disk, on the same spot that the write protection hole is at on the right side,
on the Atari disk, there is no hole. Default size for Atari disks is 720 k, whereas on the PC, it&#8217;s
1.44 megs (twice 720 k).</p>
</div>
<div class="paragraph">
<p>Sometimes, you can use PC disks for the Atari without any modifications, just format it to 720 k,
the default if you format it in GEM on the Atari. If this doesn&#8217;t work, just put some tape
over the hole, this way, the PC disk will look like an Atari disk. Great huh? Now you can
organize your files on the PC, and have loads of stuff, then, when you need it on the Atari,
just put the files you want over on a disk and use it. This disk will work fine on both systems.
Only restriction is that you must have it in 720 k format. This can also be done on the PC by
formatting in this way <code>format a: /f:720</code>. If you didn&#8217;t know this, you&#8217;ll probably kick my ass
for not telling you earlier, hehe, suffer.</p>
</div>
<div class="paragraph">
<p>Now, on to coding again. As you may have guessed, what you see on the monitor (or TV) is
controlled by memory in the Atari. Before explaining that, however, I shall go into the
different resolutions. There are low, medium and high, easy as pie. High resolution is that
which we find only on monochrome monitors, it&#8217;s 640×400 pixels, and uses only two colours.
Medium resolution is 640×200 pixels and uses four colours. Finally, the most interesting
resolution is low, featuring 320×200 pixels with 16 colours. A pixel, btw, is a dot on the
screen, if you look closer in a game or so, you&#8217;ll se that the spaceship/dude/whatever is build
up of small dots, those are pixels. The upper left corner is considered 0,0 in a coordination
system, and the bottom right corner is the maximum. Thus, in low resolution, the pixel at 0 x
and 0 y is in the left uppermost corner, and the pixel at 319 x and 199 y is at the bottommost
right position.</p>
</div>
<div class="paragraph">
<p>How, then, is this represented in memory? For high resolution, it&#8217;s very simple, each pixel is
represented by a bit, either 1 (black) or 0 (white). Thus, if you change the first bit in the
graphics memory (sometimes also called screen memory), you will change the bit in the left
uppermost corner, the pixel at 0,0. If you change the last bit in the screen memory, you&#8217;ll
change the pixel at 639,399. Since one pixel is represented by one bit, it&#8217;s easy to calculate
how much memory is used, 8 pixels are one byte. 16 pixels one word and a longword will
hold data for 32 pixels. 640×400 = 256000, the number of pixels total. If we divide this by 8,
we will get how many bytes the screen memory will have to be, this is 32000 bytes.</p>
</div>
<div class="paragraph">
<p>In medium resolution, we have four colours. Hmm, four colours, how do we represent a value
between 0 and 3? Well, we can use two bits, since <code>%11</code> (binary 11) is 3. So now, we need
two bits to represent each pixel. Also, the number of possible lines has dropped by half to
200 instead of 400, meaning that medium and high resolution both use 32000 bytes of
memory. You might think that the two bits for each pixel are right next to each other, not so,
they are spread over what you call bit planes, but that will come in just a little sec, since it&#8217;s
extremely complicated.</p>
</div>
<div class="paragraph">
<p>Low resolution has 16 colours. <code>%1111</code> is 15, so we need 4 bits to represent each pixel in low
resolution. The number of pixels per line is reduced by half, and the number of bits per pixel
is doubled, meaning that we still have 32000 bytes of screen memory. If you don&#8217;t believe
me, we&#8217;ll do the math again. 320×200 is 64000 pixels, each pixel needs 4 bits to represent it,
meaning 256000 bits, at eight bits to a byte, we again get 32000 bytes.</p>
</div>
<div class="paragraph">
<p>On to the bitplanes, I will go through how it works in low resolution, since that is the most
interesting mode and the exact same technique is used in medium resolution, but with only
two bit planes instead of four. OK, here goes. The pixels are stored in words, in groups of 16
(remember, 16 bits in a word). The first 16 pixels are thus stored in 4 words, that come after
one another. Thus, the first 4 words of the screen memory are used to store the first 16
pixels. I&#8217;m feeling I&#8217;m loosing it here, this is damn hard to explain, and it took me weeks
before I got it myself.</p>
</div>
<div class="paragraph">
<p>The bit in the first word is the least significant bit in the colour number. Least significant
means the rightmost bit, since this is the one that affect the value the least (it either adds
one or zero to the final value), while the most significant bit is the leftmost bit. The bit in the
fourth word is the most significant bit in the colour number. The first bits in the first four
words control the first pixel. Are you confused yet? An example perhaps.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">Graphics memory, expressed in binary</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%1000000000000000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">first word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%0000000000000000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">second word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%0000000000000000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">third word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%0000000000000000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">fourth word</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Colour number of pixels, expressed in hex for ease of reading</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$1000000000000000</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The only bit that is set, is the least significant bit of the first word in the series. The term
"set" means that a bit has the value 1, and not 0. This means that the first pixel will be colour
1.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">Graphics memory, expressed in binary</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%1100000000000000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">first word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%1100000000000101</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">second word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%0100000000000110</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">third word</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>%0110000000000000</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">fourth word</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Colour number of pixels, expressed in hex for ease of reading</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$3F80000000000642</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>As you can see, just read top down, and you&#8217;ll have it.</p>
</div>
<div class="paragraph">
<p>So, in order to address the 17th pixel, you&#8217;d first have to "jump over" the first four words of
graphics memory, then manipulate the first bit in the next four words. This makes pixel
manipulation a pain in the ass, since not only do you have to change values in four different
places, but you also have to work with bit manipulation. All in all, very tedious and time
consuming work. Just for comparison, there is a graphics mode on the PC, the MCGA mode,
which is extremely user friendly. It also has 320×200 pixels, but 256 colours instead. Does
this value ring a bell? It&#8217;s a byte! So, each pixel is represented by a byte, making it a wonder
of ease of use. In order to change the pixel, you just have to address the correct byte, which
is dead simple. It would be done like this, <code>move.b #255, (a0)</code> where a0 points to address
memory. This would change the first pixel to colour 255. Or to change the third pixel, `move.b
#255, 3(a0). But to change the first pixel on the Atari, in low resolution, we instead have to
do something like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="c1">; a0 points to screen memory</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%1000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="mi">2</span><span class="p">(</span><span class="nb">a0</span><span class="p">)</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="mi">4</span><span class="p">(</span><span class="nb">a0</span><span class="p">)</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="mi">6</span><span class="p">(</span><span class="nb">a0</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This sets the first pixel to colour 1. The numbers before <code>(a0)</code> are, as you might recall,
indexes to memory, so <code>2(a0)</code> means where <code>a0</code> points plus two. Since we constantly want to
point to the next word, we must increase the pointer by two bytes each time. We could also
have used a <code>(a0)+</code> in order to increment the pointer, but then a0 would not have pointed to
the beginning of the screen memory anymore. It all depends on what you want to be doing.
Also note, that since we move information in, any information previously there, will be lost.
If, for example, pixel three and four already had values of some kind, and we executed the
commands above, they would become colour zero, since information regarding them would
be overwritten with all zeros as shown above.</p>
</div>
<div class="paragraph">
<p>Now you hopefully possess the knowledge necessary for understanding my short little
program. Let me just stress that really getting the workings of the graphics memory is very
difficult. What bit goes where, what bit does what, and so forth, so don&#8217;t despair when you
don&#8217;t get it right away; you have a long way ahead of you. Oh, I realized, I have some more
things to tell you.</p>
</div>
<div class="paragraph">
<p>A scan line is a row of pixels, there are 200 scan lines in low resolution. That&#8217;s easy enough.
The other thing I have to tell you is about the VBL, or <strong>V</strong>ertical <strong>BL</strong>ank. The Atari operates in
either PAL (Phase Alternating Line) or NTSC (National Television Standards Committee):
NTSC is the American standard and PAL the European. Since I&#8217;m from Europe and it also
seems that most Atari related stuff is from Europe, NTSC will be given little support, take that
Yankees. The PAL or NTSC has to do with how many times per second the screen is updated,
in NTSC, it&#8217;s 60 times per second, and in PAL it&#8217;s 50. Thus, the so called refresh rate, is either
50 or 60 Hz. On game menus, you can often change between these modes. When I was
little, and only played games, I never got what the 50/60 selection on the game menu was
about, now I do. Since we use PAL, the refresh rate on our stuff will be 50 Hz, meaning that
the monitor is updated 50 times per second.</p>
</div>
<div class="paragraph">
<p>The screen is painted by an electron beam, that starts in the upper left corner, and then
works its way down, doing a scan line, and then moving on to the next. This happens 50 (or
60) times every second. It&#8217;s good practice to synch your graphics with this beam, this will be
further expanded in the next tutorial. There is a trap, that will put the system in pause until
the next VBL, that is, the next time the electron beam is about to paint the screen. This is an
excellent timer, and will allow you to know exactly how much time everything takes. Just
think about it, if you put the wait for VBL trap in the beginning of your main loop, you&#8217;ll know
that the loop will perform 50 times per second. This is ideal for making games or demos not
run to fast. The trap function number is 37, it&#8217;s called by XBIOS and looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>               <span class="c1">; wait vbl</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>                      <span class="c1">; call XBIOS</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nb">a7</span>                   <span class="c1">; clean up stack</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a good thing to include in your graphics library if you have one, if you don&#8217;t, you might
think about making one.</p>
</div>
<div class="paragraph">
<p>I realize when looking over the source code again, that there are some more things to
explain. Hehe, well, at least I explain them sometime, and I don&#8217;t just dump the source code
on you and let you browse through those instruction sets and figure things out for yourself.
Of course, it&#8217;s a good thing to know where the graphics memory is, unlike some other
computers that has a fixed location for the screen memory, the Atari can use any part of the
memory. This simple trap will put the address of the graphics memory in d0, which you then
can move into the address register of your choice.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; get physbase</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>                      <span class="c1">; call XBIOS</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nb">a7</span>                   <span class="c1">; clean up stack</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="nb">a0</span>                   <span class="c1">; a0 points to screen</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Actually, it might be somewhat of a bad habit to use registers <code>d0</code>-<code>d2</code> and <code>a0</code>-<code>a2</code> unless you
have to, since those registers can be destroyed by, for example, calling traps, and other
similar things handled by parts you don&#8217;t have full control over. Physbase here stands for
physical base, and means the physical base of the graphics memory. Note also, that when
moving addresses, like the last command above, you should always use longword size. This is
so because the Atari uses 24-bit addresses, each address is 24-bits long, and if you only
move a word, or heavens, a byte, information will be lost.</p>
</div>
<div class="paragraph">
<p>What more, oh yes, the <code>dbf</code> and <code>clr</code> commands. We&#8217;ll start with the easy one, <code>clr</code>. <strong>CL</strong>ea<strong>R</strong>
clears all bits in the effective address operand. In clear English, this means "make something
zero". For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mh">$100</span><span class="p">,</span> <span class="nb">a0</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">10</span><span class="p">,</span> <span class="nb">d0</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span>
                <span class="k">clr</span><span class="nd">.l </span>  <span class="nb">d0</span>
                <span class="k">clr</span><span class="nd">.l </span>  <span class="p">(</span><span class="nb">a0</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now both <code>d0</code> and <code>$100</code> will contain zero.</p>
</div>
<div class="paragraph">
<p>The <code>dbf</code> command is a bit special. Instead of <code>dbf</code>, you can also use <code>dbra</code>. It is used for making
a loop a certain amount of times, it&#8217;s the equivalent to a for-loop in high level languages.
When using the command, you give a controlling data register, and the address to loop. Each
time, the data register will get decremented by one, and then it will be tested to see if it&#8217;s -1,
if it&#8217;s not, the execution will jump to the given address.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mh">$100</span><span class="p">,</span> <span class="nb">a0</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">4</span><span class="p">,</span> <span class="nb">d0</span>                   <span class="c1">; execute loop 5 times</span>
<span class="nl">loop</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">dbf</span>     <span class="nb">d0</span><span class="p">,</span> <span class="nv">loop</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>So, can you figure out what the memory configuration will be for this?</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Memory</th>
<th class="tableblock halign-center valign-top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$100</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$104</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$108</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$10C</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock">$110</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock">0</p></td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock">(some hex counting training as well, aren&#8217;t I nice?)</p></td>
</tr>
</tfoot>
</table>
<div class="paragraph">
<p>Since the value gets decremented right before it&#8217;s tested for -1, the loop is never looped
through with the value -1. So, if you want a loop to loop five times, put four in the controlling
data register. Remember that on the last loop, the data register will contain zero. That should
be it, finally, we can get to my training program. You should be able to figure it out yourself,
but I hate it when people say that and I still have many questions, so I&#8217;ll walk you through it.</p>
</div>
<div class="paragraph">
<p>The program fills the first 60 scan lines with colour 1, the next 60 with colour 2 and the next
60 with colour 3. Then it sets the colour values for these three colours to the maximum level
of the three "main colours", RGB, or red, green and blue. When this set up is done, it
decrements the value for each colour by one every half second, when the values reach zero
(black) the program terminates itself. The countdown itself is achieved by first waiting 25
VBLs, and then running through 7 such waits.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="m68k">                <span class="k">jsr</span>     <span class="nv">initialise</span>
                
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; get physbase</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>    
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nb">a7</span>    
                
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="nb">a0</span>                   <span class="c1">; a0 points to screen</span>

<span class="c1">; clears the screen to colour 0, background</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">7999</span><span class="p">,</span> <span class="nb">d1</span>                <span class="c1">; size of screen memory</span>
<span class="nl">clrscr</span>
                <span class="k">clr</span><span class="nd">.l </span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>                     <span class="c1">; all 0 means colour 0 :)</span>
                <span class="k">dbf</span>    <span class="nb">d1</span><span class="p">,</span> <span class="nv">clrscr</span>      

                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="nb">a0</span>                   <span class="c1">; a0 points to screen</span>

<span class="c1">* fills screen with colours, ok 180 scanlines :)</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">1199</span><span class="p">,</span> <span class="nb">d0</span>                <span class="c1">; 60 scanlines</span>
<span class="nl">fill1</span>  
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%1111111111111111</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">dbf</span>     <span class="nb">d0</span><span class="p">,</span> <span class="nv">fill1</span>                <span class="c1">; filled with colour 1</span>

                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">1199</span><span class="p">,</span> <span class="nb">d0</span>                <span class="c1">; 60 scanlines</span>
<span class="nl">fill2</span>  
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%1111111111111111</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">dbf</span>     <span class="nb">d0</span><span class="p">,</span> <span class="nv">fill2</span>                <span class="c1">; filled with colour 2</span>

                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">1199</span><span class="p">,</span> <span class="nb">d0</span>                <span class="c1">; 60 scanlines</span>
<span class="nl">fill3</span>  
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%1111111111111111</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%1111111111111111</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mb">%0000000000000000</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span><span class="o">+</span>
                <span class="k">dbf</span>     <span class="nb">d0</span><span class="p">,</span> <span class="nv">fill3</span>                <span class="c1">; filled with colour 3</span>

                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mh">$000</span><span class="p">,</span> <span class="mh">$ff8240</span>           <span class="c1">; black background</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mh">$700</span><span class="p">,</span> <span class="mh">$ff8242</span>           <span class="c1">; red colour 1</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mh">$070</span><span class="p">,</span> <span class="mh">$ff8244</span>           <span class="c1">; green colour 2</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mh">$007</span><span class="p">,</span> <span class="mh">$ff8246</span>           <span class="c1">; blue colour 3</span>
                
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">24</span><span class="p">,</span> <span class="nb">d5</span>                  <span class="c1">; 25 VBL's per loop</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">6</span><span class="p">,</span> <span class="nb">d6</span>                   <span class="c1">; make 7 loops</span>
<span class="nl">main</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">37</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>               <span class="c1">; wait VBL</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nb">a7</span>
                
                <span class="k">dbf</span>     <span class="nb">d5</span><span class="p">,</span> <span class="kr">main</span>                 <span class="c1">; loop vbl's</span>

                <span class="k">add</span><span class="nd">.w </span>  <span class="nd">#</span><span class="o">-</span><span class="mh">$100</span><span class="p">,</span> <span class="mh">$ff8242</span>          <span class="c1">; subtract one from red</span>
                <span class="k">add</span><span class="nd">.w </span>  <span class="nd">#</span><span class="o">-</span><span class="mh">$010</span><span class="p">,</span> <span class="mh">$ff8244</span>          <span class="c1">; subtract one from green</span>
                <span class="k">add</span><span class="nd">.w </span>  <span class="nd">#</span><span class="o">-</span><span class="mh">$001</span><span class="p">,</span> <span class="mh">$ff8246</span>          <span class="c1">; subtract one from blue</span>

                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">24</span><span class="p">,</span> <span class="nb">d5</span>                  <span class="c1">; reset VBL counter</span>
                
                <span class="k">dbf</span>     <span class="nb">d6</span><span class="p">,</span> <span class="kr">main</span>                 <span class="c1">; end of main loop</span>

                <span class="k">jsr</span>     <span class="nv">restore</span>
                
                <span class="k">clr</span>     <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">1</span>

<span class="nl">initialise</span>
<span class="c1">* set supervisor</span>
                <span class="k">clr</span><span class="nd">.l </span>  <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                    <span class="c1">; clear stack</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>               <span class="c1">; prepare for user mode</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">1</span>                       <span class="c1">; call gemdos</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">6</span><span class="p">,</span> <span class="nb">a7</span>                   <span class="c1">; clean up stack</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="nv">old_stack</span>            <span class="c1">; backup old stack pointer</span>
<span class="c1">* end set supervisor</span>

<span class="c1">* save the old palette; old_palette</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="nv">old_palette</span><span class="p">,</span> <span class="nb">a0</span>         <span class="c1">; put backup address in a0</span>
                <span class="k">movem</span><span class="nd">.l </span><span class="mh">$ffff8240</span><span class="p">,</span> <span class="nb">d0</span><span class="o">-</span><span class="nb">d7</span>         <span class="c1">; all palettes in d0-d7</span>
                <span class="k">movem</span><span class="nd">.l </span><span class="nb">d0</span><span class="o">-</span><span class="nb">d7</span><span class="p">,</span> <span class="p">(</span><span class="nb">a0</span><span class="p">)</span>              <span class="c1">; move data into old_palette</span>
<span class="c1">* end palette save</span>

<span class="c1">* saves the old screen adress</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; get physbase</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nb">a7</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="nv">old_screen</span>           <span class="c1">; save old screen address</span>
<span class="c1">* end screen save</span>

<span class="c1">* save the old resolution into old_resolution</span>
<span class="c1">* and change resolution to low (0)</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; get resolution</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">2</span><span class="p">,</span> <span class="nb">a7</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nb">d0</span><span class="p">,</span> <span class="nv">old_resolution</span>       <span class="c1">; save resolution</span>
                
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; low resolution</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>               <span class="c1">; keep physbase</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>               <span class="c1">; keep logbase</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; change screen</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>
                <span class="k">add</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">12</span><span class="p">,</span> <span class="nb">a7</span>
<span class="c1">* end resolution save  </span>

                <span class="k">rts</span>

<span class="nl">restore</span>  
<span class="c1">* restores the old resolution and screen adress</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nv">old_resolution</span><span class="p">,</span> <span class="nb">d0</span>       <span class="c1">; res in d0</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nb">d0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; push resolution</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nv">old_screen</span><span class="p">,</span> <span class="nb">d0</span>           <span class="c1">; screen in d0</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; push physbase</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nb">d0</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; push logbase</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>                <span class="c1">; change screen</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">14</span>
                <span class="k">add</span><span class="nd">.l </span>  <span class="nd">#</span><span class="mi">12</span><span class="p">,</span> <span class="nb">a7</span>
<span class="c1">* end resolution and screen adress restore</span>

<span class="c1">* restores the old palette</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nd">#</span><span class="nv">old_palette</span><span class="p">,</span> <span class="nb">a0</span>         <span class="c1">; palette pointer in a0</span>
                <span class="k">movem</span><span class="nd">.l </span><span class="p">(</span><span class="nb">a0</span><span class="p">),</span> <span class="nb">d0</span><span class="o">-</span><span class="nb">d7</span>              <span class="c1">; move palette data</span>
                <span class="k">movem</span><span class="nd">.l </span><span class="nb">d0</span><span class="o">-</span><span class="nb">d7</span><span class="p">,</span> <span class="mh">$ffff8240</span>         <span class="c1">; smack palette in</span>
<span class="c1">* end palette restore</span>

<span class="c1">* set user mode again</span>
                <span class="k">move</span><span class="nd">.l </span> <span class="nv">old_stack</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>         <span class="c1">; restore old stack pointer</span>
                <span class="k">move</span><span class="nd">.w </span> <span class="nd">#</span><span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="nb">a7</span><span class="p">)</span>               <span class="c1">; back to user mode</span>
                <span class="k">trap</span>    <span class="nd">#</span><span class="mi">1</span>                       <span class="c1">; call gemdos</span>
                <span class="k">addq</span><span class="nd">.l </span> <span class="nd">#</span><span class="mi">6</span><span class="p">,</span> <span class="nb">a7</span>                   <span class="c1">; clear stack</span>
<span class="c1">* end set user</span>
                
                <span class="k">rts</span>

                <span class="kr">section</span> <span class="nv">data</span>

<span class="nl">old_resolution</span>  <span class="kt">dc</span><span class="nd">.w </span>   <span class="mi">0</span>
<span class="nl">old_stack</span>       <span class="kt">dc</span><span class="nd">.l </span>   <span class="mi">0</span>
<span class="nl">old_screen</span>      <span class="kt">dc</span><span class="nd">.l </span>   <span class="mi">0</span>


                <span class="kr">section</span> <span class="nv">bss</span>

<span class="nl">old_palette</span>     <span class="kt">ds</span><span class="nd">.l </span>   <span class="mi">8</span></code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="img/tutorial-05-screenshot.png" alt="tutorial 05 screenshot">
</div>
<div class="title">Figure 3. 3 colors</div>
</div>
<div class="paragraph">
<p>Oh, naughty me, I added a bunch of stuff to my initlib without telling you about it. Well, right
now, you&#8217;ll just have to accept it, any problems with that private!? The thing it does is to save
all information regarding resolution, screen setup and so on, then change to low resolution.
When the restore subroutine is called, it restores everything as it was. While time goes by, I
probably won&#8217;t dump all my source code into my tutorials, for example, an <code>include initlib.s</code> will
probably be the way in the future. I&#8217;m also thinking about sticking to just give out the
separate <code>.s</code> file with the source code, and only comment it here in the main tutorial so you
won&#8217;t have the same code in two places. How does that sound? You curious types can go
through the initlib code, and try to figure it out, I have commented it quite well just so you
can do that.</p>
</div>
<div class="paragraph">
<p>There might be some problems with the math here, in the clear routine, 8000 is given as the
screen size. Yes, 8000 longwords, 8000×4 = 32000 bytes. 1199, or rather 1200 should equal
60 scan lines? Yes, every pass through the fill-loop moves 4 words. 4 words contain
information for 16 pixels, meaning that for every loop, 16 pixels will be set. 320×60=19200
pixels total (320 pixels per scan line), and since we set 16 pixels per loop, we divide this
value by 16 to get the total number of loops, which, incidentally, is 1200. That should clear
any trouble with the numbers.</p>
</div>
<div class="paragraph">
<p>I hope there&#8217;s no trouble with the main loop part, the first little loop is all about making 25
VBLs, in other words, waiting for 0.5 seconds. Then, the colour values are changed, making
the colours 1,2 and 3 go towards black. Lastly, another loop controller that makes sure the
main loop is looped through seven times.</p>
</div>
<div class="paragraph">
<p>Now that you are equipped with basic knowledge of the graphics memory, I think we&#8217;ll be
able to handle a scroller in the next part. It depends, I&#8217;ll have to write one and see if it&#8217;s not
too complex. If it is too complex, you&#8217;ll probably be looking at a theory tutorial again.</p>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>← Previous: <a href="_of_the_ways_of_addressing_memory.html">Of The Ways Of Addressing Memory</a> | ↑ Up: <a href="index.html">The Atari ST MC68000 Assembly Language Tutorials</a> | Next: <a href="_of_seeing_behind_the_curtain_of_an_execution_and_getting_intimate_with_files.html">Of Seeing Behind The Curtain Of An Execution And Getting Intimate With Files</a> →</p>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 1st edition (v0.84)<br>
Last updated 2022-04-23 15:26:12 UTC
</div>
</div>
</body>
</html>